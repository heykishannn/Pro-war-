<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Pro War - User Panel</title>
  <style>
    /* 🌟 Golden Theme + Glassmorphism */
    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background: linear-gradient(135deg, #1a1a1a, #000000);
      color: #fff;
      overflow-x: hidden;
    }
    .glass {
      background: rgba(255, 255, 255, 0.1);
      border-radius: 16px;
      backdrop-filter: blur(15px);
      border: 1px solid rgba(255, 255, 255, 0.2);
      box-shadow: 0 4px 30px rgba(255, 215, 0, 0.2);
    }
    .gold {
      color: #FFD700;
    }
    .btn {
      padding: 10px 20px;
      background: #FFD700;
      color: #000;
      border: none;
      border-radius: 10px;
      font-weight: bold;
      cursor: pointer;
    }

    /* Splash screen */
    #splash {
      position: fixed;
      inset: 0;
      background: linear-gradient(135deg, #000, #FFD700);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 9999;
      animation: fadeOut 1s ease-in-out 2s forwards;
    }
    #splash h1 {
      font-size: 3em;
      color: white;
      text-shadow: 0 0 20px #FFD700;
    }
    @keyframes fadeOut {
      to { opacity: 0; visibility: hidden; }
    }

    /* Layout */
    .container { padding: 20px; max-width: 800px; margin: auto; }
    .banner { margin-bottom: 20px; }
    .tournament-card, .wallet, .auth-form, .game-card {
      margin-bottom: 20px;
      padding: 15px;
    }
    .tournament-card, .wallet, .game-card {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    input {
      padding: 10px;
      border-radius: 10px;
      border: none;
      width: 100%;
      margin-bottom: 10px;
    }

    iframe {
      width: 100%;
      height: 400px;
      border: none;
      border-radius: 20px;
      overflow: hidden;
    }

    #games iframe {
      margin-top: 20px;
    }

    .hidden { display: none; }

  </style>
</head>
<body>

  <!-- 🔥 Splash Screen -->
  <div id="splash">
    <h1 class="gold">Pro War</h1>
  </div>

  <div class="container" id="mainApp" class="hidden">

    <!-- 🧑‍💼 Auth Section -->
    <div id="authSection" class="glass auth-form">
      <h2 class="gold">Login / Signup</h2>
      <input id="email" type="email" placeholder="Email" />
      <input id="password" type="password" placeholder="Password" />
      <button class="btn" onclick="login()">Login</button>
      <button class="btn" onclick="signup()">Signup</button>
      <p><a href="#" onclick="forgotPassword()">Forgot Password?</a></p>
    </div>

    <!-- 💰 Wallet -->
    <div id="walletSection" class="glass wallet hidden">
      <h3>Wallet: ₹<span id="walletBalance">0</span></h3>
      <button class="btn" onclick="addMoney()">Add Money</button>
      <button class="btn" onclick="logout()">Logout</button>
    </div>

    <!-- 🏆 Tournament Section -->
    <div id="tournaments" class="glass banner hidden">
      <h3 class="gold">Tournaments</h3>
      <div id="tournamentList"></div>
    </div>

    <!-- 🎮 Games -->
    <div id="games" class="hidden">
      <div class="glass game-card">
        <h4 class="gold">Ludo</h4>
        <button class="btn" onclick="loadGame('ludo')">Play</button>
      </div>
      <div class="glass game-card">
        <h4 class="gold">Mines</h4>
        <button class="btn" onclick="loadGame('mines')">Play</button>
      </div>
      <iframe id="gameFrame" class="hidden"></iframe>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
  <script>
    const supabase = window.supabase.createClient('https://YOUR_PROJECT.supabase.co', 'YOUR_PUBLIC_ANON_KEY');

    const authSection = document.getElementById("authSection");
    const walletSection = document.getElementById("walletSection");
    const tournaments = document.getElementById("tournaments");
    const tournamentList = document.getElementById("tournamentList");
    const games = document.getElementById("games");
    const gameFrame = document.getElementById("gameFrame");

    setTimeout(() => {
      document.getElementById("splash").style.display = "none";
      document.getElementById("mainApp").style.display = "block";
      checkSession();
    }, 2500);

    async function checkSession() {
      const { data: { session } } = await supabase.auth.getSession();
      if (session) {
        loadProfile(session.user);
      }
    }

    async function login() {
      const email = document.getElementById("email").value;
      const password = document.getElementById("password").value;
      const { error, data } = await supabase.auth.signInWithPassword({ email, password });
      if (error) return alert(error.message);
      const user = data.user;
      loadProfile(user);
    }

    async function signup() {
      const email = document.getElementById("email").value;
      const password = document.getElementById("password").value;
      const { error, data } = await supabase.auth.signUp({ email, password });
      if (error) return alert(error.message);
      await supabase.from("profiles").insert([{ id: data.user.id, username: email.split('@')[0], wallet_balance: 0 }]);
      alert("Signup successful, now login.");
    }

    async function forgotPassword() {
      const email = prompt("Enter your email:");
      const { error } = await supabase.auth.resetPasswordForEmail(email);
      if (error) return alert(error.message);
      alert("Password reset link sent.");
    }

    async function logout() {
      await supabase.auth.signOut();
      location.reload();
    }

    async function loadProfile(user) {
      const { data, error } = await supabase.from("profiles").select("*").eq("id", user.id).single();
      if (data.is_admin) return location.href = "admin.html";
      if (data.is_owner) return location.href = "owner.html";
      authSection.classList.add("hidden");
      walletSection.classList.remove("hidden");
      tournaments.classList.remove("hidden");
      games.classList.remove("hidden");
      document.getElementById("walletBalance").innerText = data.wallet_balance;
      loadTournaments();
    }

    async function loadTournaments() {
      const { data, error } = await supabase.from("tournaments").select("*");
      if (data) {
        tournamentList.innerHTML = "";
        data.forEach(t => {
          tournamentList.innerHTML += `
            <div class="glass tournament-card">
              <div>
                <h4>${t.title}</h4>
                <p>Entry: ₹${t.entry_fee} | Prize: ₹${t.prize}</p>
              </div>
              <button class="btn">Join</button>
            </div>
          `;
        });
      }
    }

    function addMoney() {
      alert("💰 Razorpay Checkout would open here.");
      // Razorpay JS logic can be plugged here
    }

    function loadGame(game) {
      gameFrame.classList.remove("hidden");
      if (game === "ludo") gameFrame.src = "games/ludo/index.html";
      if (game === "mines") gameFrame.src = "games/mines/index.html";
    }
  </script>
</body>
    </html>
    
